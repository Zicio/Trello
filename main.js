(()=>{"use strict";class e{static renderSavedCards(){const e=document.getElementsByClassName("column__list");for(const t of[...e]){const e=t.closest(".column").classList[1],s=JSON.parse(localStorage.getItem(e));if(s)for(const e of s){const s=document.createElement("li");s.classList.add("column__card");const l=document.createElement("span");l.textContent=e;const n=document.createElement("button");n.classList.add("button","card__delete"),n.textContent="✖",t.appendChild(s),s.appendChild(l),s.appendChild(n)}}}static saver(){localStorage.clear();const e=document.getElementsByClassName("column__list");for(const t of[...e]){const e=t.closest(".column").classList[1],s=t.getElementsByClassName("column__card"),l=[];for(const e of s){const t=e.firstChild.textContent;l.push(t)}localStorage.setItem(`${e}`,JSON.stringify(l))}}static renderAddCardMenu(e){const t=e.target.closest(".column").querySelector(".form__box");t.querySelector(".form__field").value="",t.classList.toggle("active")}static renderNewCard(t){const s=t.target.closest(".column"),l=s.querySelector(".form__field").value,n=s.querySelector(".column__list"),i=document.createElement("li");i.classList.add("column__card");const o=document.createElement("span");o.textContent=l;const c=document.createElement("button");c.classList.add("button","card__delete"),c.textContent="✖",n.appendChild(i),i.appendChild(o),i.appendChild(c),e.renderAddCardMenu(t),e.saver()}static renderCross(e){let t=e.target.querySelector(".card__delete");null===t&&(t=e.target),t.classList.toggle("active")}static deleteCard(t){const s=t.target.parentNode;t.target.closest(".column__list").removeChild(s),e.saver()}}class t{constructor(e){this.element=e,this.draggedItem=null,this.selectedItem=null,this.shiftX=null,this.shiftY=null,this.closestItem=null}movingCard(){this.element.addEventListener("mousedown",this.moveDown.bind(this)),this.element.addEventListener("mousemove",this.move.bind(this)),this.element.addEventListener("mouseup",this.moveUp.bind(this))}moveDown(t){if(t.target.classList.contains("column__card")){t.preventDefault();const s=t.target.closest(".column__card");t.target.closest(".column"),this.selectedItem=s,this.draggedItem=s.cloneNode(!0),this.selectedItem.classList.add("column__card_selected"),this.draggedItem.classList.add("column__card_dragged");const l=this.selectedItem.clientWidth,n=this.selectedItem.clientHeight;this.shiftX=t.clientX-this.selectedItem.getBoundingClientRect().left,this.shiftY=t.clientY-this.selectedItem.getBoundingClientRect().top,this.draggedItem.style.width=`${l}px`,this.draggedItem.style.height=`${n}px`,this.positionOfDraggedItem(t),this.draggedItem.style.listStyle="none",this.draggedItem.style.transform="rotate(5deg)",this.element.appendChild(this.draggedItem),e.saver()}}positionOfDraggedItem(e){this.draggedItem.style.top=e.pageY-this.shiftY+"px",this.draggedItem.style.left=e.pageX-this.shiftX+"px"}move(e){if(!this.selectedItem)return;this.positionOfDraggedItem(e),this.closestItem&&(this.closestItem.style.marginTop="10px",this.closestItem=null);const t=e.clientX,s=e.clientY;this.draggedItem.style.display="none";const l=document.elementFromPoint(t,s);this.draggedItem.style.display="block",this.closestItem=l.closest(".column__add-element"),this.closestItem||(this.closestItem=l.closest(".column__card")),this.closestItem&&this.closestItem!==this.selectedItem&&(this.closestItem.style.marginTop=`${this.draggedItem.offsetHeight+20}px`)}moveUp(t){if(!this.selectedItem)return;this.closestItem.style.marginTop="10px";const{top:s}=this.closestItem.getBoundingClientRect(),l=this.closestItem.closest(".column").querySelector(".column__list");this.closestItem.classList.contains("column__card")?t.pageY>window.scrollY+s+this.closestItem.offsetHeight/2&&this.closestItem.nextElementSibling&&this.closestItem.nextElementSibling!==this.selectedItem?l.insertBefore(this.selectedItem,this.closestItem.nextElementSibling):l.insertBefore(this.selectedItem,this.closestItem):l.appendChild(this.selectedItem),this.selectedItem.classList.remove("column__card_selected"),e.saver(),this.selectedItem=null,this.draggedItem.remove(),this.draggedItem=null}}class s{constructor(e){this.element=e,this.moveControlClass=new t(this.element),s.start(),this.listenerOfClickButton(),this.listenerOfTargetCard(),this.listenerOfUntargetCard(),this.moveControlClass.movingCard()}static start(){localStorage.length&&e.renderSavedCards()}listenerOfClickButton(){this.element.addEventListener("click",(e=>s.renderElement(e)))}static renderElement(t){return t.target.classList.contains("column__add-element")||t.target.classList.contains("form__remove")?(t.preventDefault(),void e.renderAddCardMenu(t)):t.target.classList.contains("form__submit")?(t.preventDefault(),void e.renderNewCard(t)):void(t.target.classList.contains("card__delete")&&(t.preventDefault(),e.deleteCard(t)))}listenerOfTargetCard(){this.element.addEventListener("mouseover",(e=>s.renderCross(e)))}listenerOfUntargetCard(){this.element.addEventListener("mouseout",(e=>s.renderCross(e)))}static renderCross(t){t.target.closest(".column__card")&&(t.preventDefault(),e.renderCross(t))}}new s(document.querySelector(".content"))})();